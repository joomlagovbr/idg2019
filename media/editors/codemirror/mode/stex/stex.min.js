!(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})((function(a){"use strict";a.defineMode("stex",(function(a,b){function c(a,b){a.cmdState.push(b)}function d(a){return a.cmdState.length>0?a.cmdState[a.cmdState.length-1]:null}function e(a){var b=a.cmdState.pop();b&&b.closeBracket()}function f(a){for(var b=a.cmdState,c=b.length-1;c>=0;c--){var d=b[c];if("DEFAULT"!=d.name)return d}return{styleIdentifier:function(){return null}}}function g(a,b,c){return function(){this.name=a,this.bracketNo=0,this.style=b,this.styles=c,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,"bracket"},this.closeBracket=function(){}}}function h(a,b){a.f=b}function i(a,b){var e;if(a.match(/^\\[a-zA-Z@]+/)){var g=a.current().slice(1);return e=l.hasOwnProperty(g)?l[g]:l.DEFAULT,e=new e,c(b,e),h(b,k),e.style}if(a.match(/^\\[$&%#{}_]/))return"tag";if(a.match(/^\\[,;!\/\\]/))return"tag";if(a.match("\\["))return h(b,(function(a,b){return j(a,b,"\\]")})),"keyword";if(a.match("\\("))return h(b,(function(a,b){return j(a,b,"\\)")})),"keyword";if(a.match("$$"))return h(b,(function(a,b){return j(a,b,"$$")})),"keyword";if(a.match("$"))return h(b,(function(a,b){return j(a,b,"$")})),"keyword";var i=a.next();return"%"==i?(a.skipToEnd(),"comment"):"}"==i||"]"==i?(e=d(b))?(e.closeBracket(i),h(b,k),"bracket"):"error":"{"==i||"["==i?(e=l.DEFAULT,e=new e,c(b,e),"bracket"):/\d/.test(i)?(a.eatWhile(/[\w.%]/),"atom"):(a.eatWhile(/[\w\-_]/),e=f(b),"begin"==e.name&&(e.argument=a.current()),e.styleIdentifier())}function j(a,b,c){if(a.eatSpace())return null;if(c&&a.match(c))return h(b,i),"keyword";if(a.match(/^\\[a-zA-Z@]+/))return"tag";if(a.match(/^[a-zA-Z]+/))return"variable-2";if(a.match(/^\\[$&%#{}_]/))return"tag";if(a.match(/^\\[,;!\/]/))return"tag";if(a.match(/^[\^_&]/))return"tag";if(a.match(/^[+\-<>|=,\/@!*:;'"`~#?]/))return null;if(a.match(/^(\d+\.\d*|\d*\.\d+|\d+)/))return"number";var d=a.next();return"{"==d||"}"==d||"["==d||"]"==d||"("==d||")"==d?"bracket":"%"==d?(a.skipToEnd(),"comment"):"error"}function k(a,b){var c,f=a.peek();return"{"==f||"["==f?(c=d(b),c.openBracket(f),a.eat(f),h(b,i),"bracket"):/[ \t\r]/.test(f)?(a.eat(f),null):(h(b,i),e(b),i(a,b))}var l={};return l.importmodule=g("importmodule","tag",["string","builtin"]),l.documentclass=g("documentclass","tag",["","atom"]),l.usepackage=g("usepackage","tag",["atom"]),l.begin=g("begin","tag",["atom"]),l.end=g("end","tag",["atom"]),l.label=g("label","tag",["atom"]),l.ref=g("ref","tag",["atom"]),l.eqref=g("eqref","tag",["atom"]),l.cite=g("cite","tag",["atom"]),l.bibitem=g("bibitem","tag",["atom"]),l.Bibitem=g("Bibitem","tag",["atom"]),l.RBibitem=g("RBibitem","tag",["atom"]),l.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:b.inMathMode?function(a,b){return j(a,b)}:i}},copyState:function(a){return{cmdState:a.cmdState.slice(),f:a.f}},token:function(a,b){return b.f(a,b)},blankLine:function(a){a.f=i,a.cmdState.length=0},lineComment:"%"}})),a.defineMIME("text/x-stex","stex"),a.defineMIME("text/x-latex","stex")}));