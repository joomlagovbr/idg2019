!(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})((function(a){function b(b){if(b.getOption("disableInput"))return a.Pass;for(var e,g=b.listSelections(),h=[],i=0;i<g.length;i++){var j=g[i].head;if(!/\bcomment\b/.test(b.getTokenTypeAt(j)))return a.Pass;var k=b.getModeAt(j);if(e){if(e!=k)return a.Pass}else e=k;var l,m,n=null,o=e.blockCommentStart,p=e.lineComment;if(o&&e.blockCommentContinue){l=b.getLine(j.line);var q=l.lastIndexOf(e.blockCommentEnd,j.ch-e.blockCommentEnd.length);if(-1!=q&&q==j.ch-e.blockCommentEnd.length||p&&(m=l.lastIndexOf(p,j.ch-1))>-1&&/\bcomment\b/.test(b.getTokenTypeAt({line:j.line,ch:m+1})));else if(j.ch>=o.length&&(m=l.lastIndexOf(o,j.ch-o.length))>-1&&m>q)if(c(0,l)>=m)n=l.slice(0,m);else{var r,s=b.options.tabSize;m=a.countColumn(l,m,s),n=b.options.indentWithTabs?f.call("\t",r=Math.floor(m/s))+f.call(" ",m-s*r):f.call(" ",m)}else(m=l.indexOf(e.blockCommentContinue))>-1&&m<=j.ch&&m<=c(0,l)&&(n=l.slice(0,m));null!=n&&(n+=e.blockCommentContinue)}if(null==n&&p&&d(b))if(null==l&&(l=b.getLine(j.line)),m=l.indexOf(p),j.ch||m){if(m>-1&&c(0,l)>=m){if(!(n=c(j.ch,l)>-1)){var t=b.getLine(j.line+1)||"",u=t.indexOf(p);n=u>-1&&c(0,t)>=u||null}n&&(n=l.slice(0,m)+p+l.slice(m+p.length).match(/^\s*/)[0])}}else n="";if(null==n)return a.Pass;h[i]="\n"+n}b.operation((function(){for(var a=g.length-1;a>=0;a--)b.replaceRange(h[a],g[a].from(),g[a].to(),"+insert")}))}function c(a,b){e.lastIndex=a;var c=e.exec(b);return c?c.index:-1}function d(a){var b=a.getOption("continueComments");return!b||"object"!=typeof b||!1!==b.continueLineComment}var e=/\S/g,f=String.prototype.repeat||function(a){return Array(a+1).join(this)};a.defineOption("continueComments",null,(function(c,d,e){if(e&&e!=a.Init&&c.removeKeyMap("continueComment"),d){var f="Enter";"string"==typeof d?f=d:"object"==typeof d&&d.key&&(f=d.key);var g={name:"continueComment"};g[f]=b,c.addKeyMap(g)}}))}));