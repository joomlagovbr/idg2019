!(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})((function(a){"use strict";function b(a,b){var d=b.line,e=0,f=0,g=c.exec(a.getLine(d)),h=g[1];do{e+=1;var i=d+e,j=a.getLine(i),k=c.exec(j);if(k){var l=k[1],m=parseInt(g[3],10)+e-f,n=parseInt(k[3],10),o=n;if(h!==l||isNaN(n)){if(h.length>l.length)return;if(h.length<l.length&&1===e)return;f+=1}else m===n&&(o=n+1),m>n&&(o=m+1),a.replaceRange(j.replace(c,l+o+k[4]+k[5]),{line:i,ch:0},{line:i,ch:j.length})}}while(k)}var c=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,d=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,e=/[*+-]\s/;a.commands.newlineAndIndentContinueMarkdownList=function(f){if(f.getOption("disableInput"))return a.Pass;for(var g=f.listSelections(),h=[],i=0;i<g.length;i++){var j=g[i].head,k=f.getStateAfter(j.line),l=a.innerMode(f.getMode(),k);if("markdown"!==l.mode.name)return void f.execCommand("newlineAndIndent");k=l.state;var m=!1!==k.list,n=0!==k.quote,o=f.getLine(j.line),p=c.exec(o),q=/^\s*$/.test(o.slice(0,j.ch));if(!g[i].empty()||!m&&!n||!p||q)return void f.execCommand("newlineAndIndent");if(d.test(o)){var r=n&&/>\s*$/.test(o),s=!/>\s*$/.test(o);(r||s)&&f.replaceRange("",{line:j.line,ch:0},{line:j.line,ch:j.ch+1}),h[i]="\n"}else{var t=p[1],u=p[5],v=!(e.test(p[2])||p[2].indexOf(">")>=0),w=v?parseInt(p[3],10)+1+p[4]:p[2].replace("x"," ");h[i]="\n"+t+w+u,v&&b(f,j)}}f.replaceSelections(h)}}));